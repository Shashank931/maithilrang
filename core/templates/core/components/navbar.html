{% load static %}

<nav class="bg-white shadow-md sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">

      <!-- Left Section: Logo -->
      <div class="flex items-center gap-x-3 flex-shrink-0">
        <a href="{% url 'home' %}">
          <img src="{% static 'core/images/maithilrang.png' %}" alt="MaithilRang Logo" class="h-10 sm:h-12 w-auto">
        </a>
        <span class="text-xl sm:text-2xl font-bold text-green-800">Maithil <span class="text-pink-600">रंग</span></span>
      </div>

      <!-- Middle Section: Nav Links -->
      <div class="hidden md:flex items-center justify-center space-x-6 flex-1 text-sm font-medium text-gray-700">
        <a href="{% url 'home' %}" class="hover:text-blue-800 transition">Home</a>
        <a href="{% url 'paintings' %}" class="hover:text-blue-800 transition">Paintings</a>
        <a href="{% url 'aboutus' %}" class="hover:text-blue-800 transition">About Us</a>
        <a href="{% url 'contactus' %}" class="hover:text-blue-800 transition">Contact Us</a>
      </div>

      <!-- Right Section -->
      <div class="flex items-center gap-x-4 flex-shrink-0">

        <!-- Desktop Search -->
        <form action="{% url 'search' %}" method="GET" class="hidden md:flex items-center">
          <input type="text" name="keyword" placeholder="Search..."
                 class="px-3 py-1.5 border rounded-l-md border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
          <button type="submit" class="bg-blue-800 text-white px-3 py-1.5 rounded-r-md hover:bg-blue-700 transition text-sm">Search</button>
        </form>

        <!-- Cart Icon -->
        <a href="{% url 'cart' %}" class="relative text-blue-800 hover:text-blue-600 transition">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 3h2l.4 2M7 13h14l-1.35 5.4a1 1 0 0 1-.98.6H7.4a1 1 0 0 1-.98-.8L5 5H3" />
            <circle cx="9" cy="21" r="1" />
            <circle cx="20" cy="21" r="1" />
          </svg>
          <span class="absolute -top-2 -right-2 bg-red-500 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full">{{ cart_count }}</span>
        </a>

        <!-- Auth Buttons / User Info -->
        {% if user.is_authenticated %}
          <div class="hidden md:flex items-center gap-x-2">
            <!-- Dashboard Icon -->
            <a href="{% url 'dashboard' %}" class="text-blue-800 hover:text-blue-600" title="Dashboard">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path d="M10 2a8 8 0 100 16 8 8 0 000-16zm1 11H9v-1h2v1zm0-3H9V5h2v5z" />
              </svg>
            </a>
            <span class="text-sm font-medium text-gray-700">Hello, {{ user.first_name }}</span>
            <a href="{% url 'logout' %}" class="px-3 py-1.5 border border-red-600 text-red-600 rounded hover:bg-red-50 transition text-sm">Logout</a>
          </div>
        {% else %}
          <div class="hidden md:flex items-center gap-x-2">
            <a href="{% url 'login' %}" class="px-3 py-1.5 border border-blue-800 text-blue-800 rounded hover:bg-blue-50 transition text-sm">Log In</a>
            <a href="{% url 'signup' %}" class="px-3 py-1.5 bg-blue-800 text-white rounded hover:bg-blue-700 transition text-sm">Sign Up</a>
          </div>
        {% endif %}

        <!-- Mobile Search Button -->
        <button id="mobile-search-toggle" class="md:hidden text-blue-800 focus:outline-none">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8" />
            <line x1="21" y1="21" x2="16.65" y2="16.65" />
          </svg>
        </button>

        <!-- Mobile Menu Button -->
        <button id="mobile-menu-button" class="md:hidden text-blue-800 focus:outline-none">
          <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden bg-white border-t px-4 pt-4 pb-6 space-y-3 text-sm font-medium text-gray-700">
    <a href="{% url 'home' %}" class="block hover:text-blue-800 transition">Home</a>
    <a href="{% url 'paintings' %}" class="block hover:text-blue-800 transition">Paintings</a>
    <a href="{% url 'aboutus' %}" class="block hover:text-blue-800 transition">About Us</a>
    <a href="{% url 'contactus' %}" class="block hover:text-blue-800 transition">Contact Us</a>

    {% if user.is_authenticated %}
      <a href="{% url 'dashboard' %}" class="block text-blue-800 hover:text-blue-600">Dashboard</a>
      <span class="block text-gray-700">Hello, {{ user.first_name }}</span>
      <a href="{% url 'logout' %}" class="block border border-red-600 text-red-600 px-4 py-2 rounded hover:bg-red-50 transition">Logout</a>
    {% else %}
      <a href="{% url 'login' %}" class="block border border-blue-800 text-blue-800 px-4 py-2 rounded hover:bg-blue-50 transition">Log In</a>
      <a href="{% url 'signup' %}" class="block bg-blue-800 text-white px-4 py-2 rounded hover:bg-blue-700 transition">Sign Up</a>
    {% endif %}
  </div>

  <!-- Mobile Search -->
  <div id="mobile-search" class="hidden md:hidden px-4 py-3 bg-white border-t">
    <form action="{% url 'search' %}" method="GET" class="flex items-center">
      <input type="text" name="keyword" placeholder="Search..." 
             class="flex-1 px-3 py-2 border rounded-l-md border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
      <button type="submit" class="bg-blue-800 text-white px-4 py-2 rounded-r-md hover:bg-blue-700 transition text-sm">Search</button>
    </form>
  </div>
</nav>

<script>
  const menuBtn = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const searchBtn = document.getElementById('mobile-search-toggle');
  const mobileSearch = document.getElementById('mobile-search');

  menuBtn.addEventListener('click', () => {
    mobileMenu.classList.toggle('hidden');
    mobileSearch.classList.add('hidden');
  });

  searchBtn.addEventListener('click', () => {
    mobileSearch.classList.toggle('hidden');
    mobileMenu.classList.add('hidden');
  });
</script>
