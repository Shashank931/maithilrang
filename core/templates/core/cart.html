{% extends "core/base.html" %}
{% load static %}

{% block title %}Your Cart - MaithilRang{% endblock %}

{% block main %}
<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <h1 class="text-2xl font-bold mb-8 text-gray-800">Shopping Cart</h1>


{% if not cart_items %}
    <h2 class="text-3xl text-center">Your Shopping Cart is Empty</h2>
    <br>
    <div class="flex justify-center mt-6">
     <a href="{% url 'paintings' %}"
     class="inline-flex items-center justify-center px-6 py-2 text-sm font-semibold text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-all duration-200">
    Continue Shopping
     </a>
    </div>
{% else %}
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Left Column: Cart Items -->
    <div class="lg:col-span-2 bg-white border rounded-lg shadow-sm">
      <div class="overflow-x-auto">
        <table class="w-full text-sm text-left">
          <thead class="bg-gray-100 border-b text-gray-700 uppercase">
            <tr>
              <th class="px-6 py-4">Product</th>
              <th class="px-6 py-4 text-center">Quantity</th>
              <th class="px-6 py-4 text-right">Price</th>
              <th class="px-6 py-4"></th>
            </tr>
          </thead>
          <tbody>
            {% for cart_item in cart_items %}
            <tr class="border-b hover:bg-gray-50">
              <!-- Product Info -->
              <td class="px-6 py-6">
                <div class="flex items-center gap-4">
                  <img src="{{ cart_item.product.Product_image.url }}" alt="{{ cart_item.product.product_name }}"
                       class="w-14 h-14 object-contain border rounded-md" />
                  <div>
                    <a href='{{cart_item.product.get_url}}' class="font-medium text-gray-800">{{ cart_item.product.product_name }}</a>
                    {% if cart_item.product.description %}
                    <p class="text-xs text-gray-500">{{ cart_item.product.description }}</p>
                    {% endif %}
                  </div>
                </div>
              </td>

              <!-- Quantity Controls -->
              <td class="px-6 py-6 text-center">
                <div  class="inline-flex items-center border rounded overflow-hidden">
                  <a href='{% url "remove_cart" cart_item.product.id %}' type="submit" name="action" value="decrease"
                          class="px-3 py-1 bg-gray-200 hover:bg-gray-300">−</a>
                  <span class="px-4 py-1 font-medium">{{ cart_item.quantity }}</span>
                  <a href='{% url "add_cart" cart_item.product.id %}' type="submit" name="action" value="increase"
                          class="px-3 py-1 bg-gray-200 hover:bg-gray-300">+</a>
                </div>
              </td>

              <!-- Price -->
              <td class="px-6 py-6 text-right">
                <p class="font-semibold text-gray-800">₹{{ cart_item.sub_total }}</p>
                <p class="text-xs text-gray-500">₹{{ cart_item.product.price }} each</p>
              </td>

              <!-- Remove Button -->
              <td class="px-6 py-6 text-right">
               <div>
                  
                  <a href='{% url "remove_cart_item" cart_item.product.id %}' class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">Remove</a>
               </div> 
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="4" class="text-center py-10 text-gray-500">Your cart is empty.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>

    <!-- Right Column: Summary & Checkout -->
    <div class="bg-white p-6 border rounded-lg shadow-sm h-fit">
      <h2 class="text-lg font-semibold mb-4">Summary</h2>

      <div class="text-sm text-gray-700 space-y-2">
        <div class="flex justify-between">
          <span>Total price:</span>
          <span>₹{{ total }}</span>
        </div>
        <div class="flex justify-between">
          <span>Tax:</span>
          <span>₹{{ tax }}</span>
        </div>
        <div class="flex justify-between font-semibold border-t pt-2">
          <span>Total:</span>
          <span class="text-lg text-gray-900">₹{{ grand_total }}</span>
        </div>
      </div>

      <!-- Payment Icons -->
      <div class="flex justify-center gap-2 mt-4">
        <img src="{% static 'images/payments/paypal.png' %}" alt="PayPal" class="h-6" />
        <img src="{% static 'images/payments/visa.png' %}" alt="Visa" class="h-6" />
        <img src="{% static 'images/payments/mastercard.png' %}" alt="MasterCard" class="h-6" />
        <img src="{% static 'images/payments/amex.png' %}" alt="AmEx" class="h-6" />
      </div>

      <!-- Buttons -->
      <div class="mt-6 space-y-2">
         <a href="{% url 'checkout' %}"
           class="w-full block bg-blue-600 hover:bg-blue-700 text-white text-center font-semibold py-2 rounded-lg">
          Checkout
        </a> 
        <a href="{% url 'paintings' %}"
           class="w-full block text-center border rounded-lg py-2 hover:bg-gray-50">
          Continue Shopping
        </a>
      </div>
    </div>
  </div>
{% endif %}
</section>

{% endblock %}
